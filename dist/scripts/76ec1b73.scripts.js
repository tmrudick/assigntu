"use strict";angular.module("assigntu",["ngCookies","ngResource","ngSanitize","ngRoute","firebase","angularMoment"]).config(["$routeProvider","$locationProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/lists/:id",{templateUrl:"views/lists/show.html",controller:"ListCtrl"}).when("/lists/:id/edit",{templateUrl:"views/lists/edit.html",controller:"EditListCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("assigntu").controller("MainCtrl",["$scope","$location","$firebase","idFactory","MessageBus",function(a,b,c,d,e){a.createList=function(f){f&&""!==f||(f="New List");var g=d(5);a.list=c(new Firebase("https://assigntu.firebaseio.com/lists/"+g)),a.list.$on("change",function(){e.push("first-run","success"),b.path("/lists/"+g)}),a.list.$set({id:g,name:f})}}]),angular.module("assigntu").controller("ListCtrl",["$scope","$routeParams","$location","$firebase","MessageBus",function(a,b,c,d,e){var f=b.id;a.flash=e.pop(),a.list=d(new Firebase("https://assigntu.firebaseio.com/lists/"+f)),a.list.$bind(a,"remote"),a.editList=function(){c.path("/lists/"+f+"/edit")},a.newItem=function(){a.remote.items||(a.remote.items=[]),a.remote.items.push({timestamp:new Date,text:a.item,completed:!1,assigned:"unassigned"}),a.item=null},a.deleteList=function(){a.list.$remove(),c.path("/").replace()}}]).controller("EditListCtrl",["$scope","$routeParams","$location","$firebase","MessageBus",function(a,b,c,d,e){var f=b.id;a.list=d(new Firebase("https://assigntu.firebaseio.com/lists/"+f)),a.removeItem=function(b){var c=a.list.items.indexOf(b);a.list.items.splice(c,1),a.list.$save()},a.saveList=function(){a.list.$save(),e.push("list-saved","success"),c.path("/lists/"+f)},a.deleteList=function(){a.list.$remove(),c.path("/").replace()}}]),angular.module("assigntu").factory("idFactory",function(){return function(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",c="";c.length<a;)c+=b[Math.floor(Math.random()*b.length)];return c}}),angular.module("assigntu").factory("MessageBus",function(){var a=[],b={"first-run":"Welcome to your new list! Bookmark and share this URL!","list-saved":"Changes saved!"};return{push:function(c,d){a.push({message:b[c]||c,style:d})},pop:function(){return a.length?a.pop():null}}}),angular.module("assigntu").directive("item",function(){return{restrict:"E",scope:{item:"="},templateUrl:"views/directives/item.html",controller:["$scope",function(a){a.removeItem=function(b){a.$emit("remove-item",b)}}]}}),angular.module("assigntu").filter("unassigned",function(){return function(a){return a?a:"unassigned"}}),angular.module("assigntu").filter("exclamation",function(){return function(a){switch(a){case"danger":return"Uh-oh!";default:return"Hurray!"}}}),angular.module("assigntu").directive("trInlineEdit",["$timeout",function(a){return{restrict:"A",priority:2,transclude:!0,replace:!0,scope:{model:"=ngModel"},template:'<span class="inline-edit"><span ng-show="editing" class="inline-editing"><span ng-transclude></span></span><span class="inline-editable" ng-hide="editing" ng-click="edit()">{{ model }}</span></span>',link:function(b,c){b.edit=function(){b.editing=!0,a(function(){d.focus(),d.select()})},b.done=function(){b.editing=!1,""===b.model&&(b.model="unassigned")};var d=c.find("input").first();d.bind("keydown",function(a){(27===a.keyCode||13===a.keyCode)&&b.$apply(b.done)}),d.bind("blur",function(){b.$apply(b.done)})}}}]);